# Legalis-RS: هندسة الفقه القانوني التوليدي

## فصل القانون والسرد: مخطط لـ "الحوكمة كرمز برمجي"

---

**المؤلفون**: فريق تطوير Legalis-RS
**الإصدار**: 0.2.0
**اللغة**: Rust (Edition 2024)
**الترخيص**: MIT / Apache 2.0

---

## الملخص

تقدم هذه الورقة **Legalis-RS**، وهو إطار عمل Rust لفصل وهيكلة الوثائق القانونية باللغة الطبيعية بشكل صارم إلى **منطق حتمي (Code)** و**سلطة تقديرية قضائية (Narrative)**.

تحتوي الأنظمة القانونية الحديثة على مزيج من المجالات القابلة للأتمتة الحاسوبية (متطلبات العمر، عتبات الدخل، حسابات المواعيد النهائية) والمجالات التي تتطلب التفسير والحكم البشري ("السبب العادل"، "الآداب العامة"). تركت المناهج السابقة هذا الحد غامضاً أو حاولت الأتمتة المفرطة التي سعت لجعل كل شيء قابلاً للحساب.

يقدم Legalis-RS نوع منطق ثلاثي القيم `LegalResult<T>` مستفيداً من نظام أنواع Rust لجعل هذا الحد صريحاً على مستوى النوع. هذا يمكّن نموذجاً جديداً لتصحيح الأخطاء القانونية والمحاكاة والنقل الدولي مع منع "الاستبداد الخوارزمي" في عصر الذكاء الاصطناعي.

**المساهمات التقنية الرئيسية**:
1. لغة خاصة بالمجال القانوني (DSL) وتنفيذ المحلل
2. التحقق الرسمي باستخدام Z3 SMT solver
3. محرك محاكاة بنمط ECS للتنبؤ بالتأثير الاجتماعي
4. توليد العقود الذكية لأكثر من 25 منصة بلوكتشين
5. تكامل Linked Open Data (RDF/TTL) للويب الدلالي
6. تنفيذ الأنظمة القانونية لـ 4 دول مع تكييف المعايير الثقافية (Soft ODA)

**الفلسفة الأساسية**: *"ليس كل شيء يجب أن يكون قابلاً للحساب."*

---

## 1. المقدمة

### 1.1 الخلفية: العلاقة بين القانون والحوسبة

أشارت أطروحة لورانس ليسيج الشهيرة "Code is Law" إلى أن الهندسة المعمارية (الكود) في الفضاء الإلكتروني لها قوة تنظيمية مكافئة للقانون. ومع ذلك، يعكس Legalis-RS هذا، متبنياً نهج "**القانون يصبح رمزاً**".

تقنين القانون يوفر الفوائد التالية:

- **قابلية التحقق**: اكتشاف التناقضات المنطقية في وقت الترجمة
- **المحاكاة**: التنبؤ بالتأثيرات الاجتماعية قبل التنفيذ
- **قابلية التشغيل البيني**: التحويل والمقارنة بين الأنظمة القانونية المختلفة
- **الشفافية**: مسارات تدقيق كاملة لعمليات القرار القانوني

ومع ذلك، فإن جعل جميع القوانين قابلة للحساب أمر خطير فلسفياً وعملياً. يحتوي القانون بطبيعته على مجالات تتطلب "الحكم البشري"، والأتمتة التي تتجاهل هذا قد تؤدي إلى "استبداد الذكاء الاصطناعي".

### 1.2 بيان المشكلة: تحديات المعالجة القانونية في عصر الذكاء الاصطناعي

تواجه التكنولوجيا القانونية الحديثة (LegalTech) عدة تحديات أساسية:

1. **التعامل مع الغموض**: العديد من المصطلحات القانونية غامضة عمداً، تفترض التفسير حسب كل حالة
2. **الاعتماد على السياق**: نفس الحكم قد يُفسر بشكل مختلف حسب السياق الاجتماعي والثقافي
3. **التغير الزمني**: القوانين تُعدل وتُلغى، مما يتطلب إدارة الاتساق عبر الزمن
4. **الاختلافات الدولية**: الأنظمة القانونية لكل دولة تختلف من أسسها الفلسفية

لغات DSL القانونية الموجودة (Catala, L4, Stipula) عالجت بعض هذه التحديات، لكن لم يتخذ أي منها نهجاً يجعل "الحد بين القابلية للحساب والحكم البشري" صريحاً في نظام الأنواع.

### 1.3 الاقتراح: فصل القابلية للحساب والسلطة التقديرية القضائية

جوهر Legalis-RS هو تقديم منطق ثلاثي القيم من خلال النوع `LegalResult<T>`:

```rust
pub enum LegalResult<T> {
    /// [المجال الحتمي] النتائج القانونية القابلة للمعالجة التلقائية
    Deterministic(T),

    /// [مجال السلطة التقديرية] مجال يتطلب الحكم البشري
    JudicialDiscretion {
        issue: String,           // المسألة قيد النظر
        context_id: Uuid,        // البيانات السياقية
        narrative_hint: Option<String>, // رأي مرجعي بواسطة LLM
    },

    /// [انهيار منطقي] خلل في القانون نفسه
    Void { reason: String },
}
```

هذا النوع يضمن أن نتيجة المعالجة القانونية تُصنف دائماً في إحدى الفئات الثلاث. يتوقف النظام عن المعالجة عند الوصول إلى `JudicialDiscretion` ويفوض الحكم للبشر. هذا يصبح "حصناً على مستوى النوع" ضد استبداد الذكاء الاصطناعي.

---

## 2. الأعمال ذات الصلة

### 2.1 تاريخ القانون الحاسوبي

العلاقة بين القانون والحواسيب تعود إلى مشروع LARC في الخمسينيات.

| الحقبة | التقنية | الخصائص |
|--------|---------|---------|
| 1950s | LARC | أول نظام استرجاع معلومات قانونية |
| 1970s | أنظمة خبيرة نوع MYCIN | الاستدلال القائم على القواعد |
| 1980s | HYPO | الاستدلال القائم على الحالات |
| 1990s | معايرة XML/SGML | هيكلة الوثائق القانونية |
| 2000s | الويب الدلالي | تمثيل المعرفة القانونية |
| 2010s | التعلم الآلي | نماذج التنبؤ القانوني |
| 2020s | LLM + التحقق الرسمي | النهج الهجين |

### 2.2 موقع هذا المشروع

يوسع Legalis-RS البحث الحالي بالطرق التالية:

1. **وسم السلطة التقديرية على مستوى النوع**: منطق ثلاثي القيم عبر `LegalResult<T>`
2. **هندسة معمارية متكاملة**: خط أنابيب Parse→Verify→Simulate→Output
3. **قابلية التشغيل البيني متعددة الصيغ**: التحويل مع Catala/L4/Stipula/Akoma Ntoso
4. **تصميم التدويل**: تكييف المعايير الثقافية (Soft ODA)
5. **تكامل البلوكتشين**: توليد العقود الذكية لأكثر من 25 منصة

---

## 3. الفلسفة ومبادئ التصميم

### 3.1 "الحوكمة كرمز، العدالة كسرد"

شعار Legalis-RS يعكس الفرق الجوهري بين الحوكمة والعدالة:

- **الحوكمة**: تطبيق القواعد، الامتثال الإجرائي، تحديد الأهلية → **قابلة للترميز**
- **العدالة**: تحقيق الإنصاف، التفسير السياقي، الحكم القيمي → **تُروى كسرد**

### 3.2 تصميم المنطق الثلاثي القيم

القيم الثلاث لـ `LegalResult<T>` تتوافق مع المفاهيم الفلسفية القانونية التالية:

| النوع | المفهوم الفلسفي القانوني | وكيل المعالجة |
|------|-------------------------|--------------|
| `Deterministic(T)` | قواعد قابلة للتطبيق الآلي | الحاسوب |
| `JudicialDiscretion` | مبادئ تتطلب التفسير | الإنسان |
| `Void` | ثغرات قانونية/تناقضات | المشرع (يحتاج تصحيح) |

### 3.3 "ليس كل شيء يجب أن يكون قابلاً للحساب"

ضد إغراء جعل كل شيء قابلاً للحساب، يقول Legalis-RS بوضوح "لا". المجالات التالية مصممة عمداً لتكون غير قابلة للحساب:

1. **السبب العادل**
2. **النظام العام والآداب**
3. **حسن النية**
4. **المعقولية**

### 3.4 منع استبداد الذكاء الاصطناعي

يمنع Legalis-RS استبداد الذكاء الاصطناعي من خلال الآليات التالية:

1. **التوقف القسري بالنوع**: توقف تلقائي عند الوصول إلى `JudicialDiscretion`
2. **مسارات التدقيق الإلزامية**: تسجيل جميع عمليات القرار
3. **قابلية التفسير**: إخراج منظم لأسباب القرار
4. **ضمان الحلقة البشرية**: البشر يتخذون القرار النهائي دائماً في مجالات السلطة التقديرية

---

## 4. هندسة النظام

### 4.1 نظرة عامة على الهندسة المعمارية ذات السبع طبقات

يتكون Legalis-RS من 7 طبقات:

```
┌─────────────────────────────────────────────────────────┐
│                    طبقة البنية التحتية                   │
│              (legalis-audit, legalis-api, legalis-cli)  │
├─────────────────────────────────────────────────────────┤
│                       طبقة المخرجات                      │
│         (legalis-viz, legalis-chain, legalis-lod)       │
├─────────────────────────────────────────────────────────┤
│               طبقة قابلية التشغيل البيني                 │
│                    (legalis-interop)                     │
├─────────────────────────────────────────────────────────┤
│                      طبقة التدويل                        │
│              (legalis-i18n, legalis-porting)            │
├─────────────────────────────────────────────────────────┤
│                طبقة المحاكاة والتحليل                    │
│                (legalis-sim, legalis-diff)              │
├─────────────────────────────────────────────────────────┤
│                      طبقة الذكاء                         │
│              (legalis-llm, legalis-verifier)            │
├─────────────────────────────────────────────────────────┤
│                      الطبقة الأساسية                     │
│          (legalis-core, legalis-dsl, legalis-registry)  │
└─────────────────────────────────────────────────────────┘
```

### 4.2 الطبقة الأساسية

#### legalis-core
الصندوق الذي ينفذ الجوهر الفلسفي للمشروع.

**تعريفات الأنواع الرئيسية**:
- `LegalResult<T>`: نوع المنطق الثلاثي القيم
- `Statute`: التمثيل الأساسي للقوانين
- `Condition`: تعبيرات الشرط (AND/OR/NOT, العمر, الدخل, إلخ)
- `Effect`: الآثار القانونية (Grant/Revoke/Obligation/Prohibition)

#### legalis-dsl
المحلل للغة الخاصة بالمجال القانوني.

**مثال بناء جملة DSL**:
```
STATUTE adult-voting: "حقوق التصويت للبالغين" {
    JURISDICTION "SA"
    VERSION 2
    EFFECTIVE_DATE 2024-01-01

    WHEN AGE >= 18 AND HAS citizen
    THEN GRANT "حقوق التصويت"

    DISCRETION "تحديد الأهلية العقلية يتطلب تشخيص طبي"
}
```

### 4.3 طبقة الذكاء

#### legalis-llm
طبقة تجريد مزود LLM.

**المزودون المدعومون**:
- OpenAI (GPT-4, GPT-4o)
- Anthropic (Claude)
- Google (Gemini)
- LLM محلي

#### legalis-verifier
محرك التحقق الرسمي.

**أهداف التحقق**:
- اكتشاف المراجع الدائرية
- اكتشاف القوانين غير القابلة للوصول (Dead Statute)
- اكتشاف التناقضات المنطقية
- التحقق من تعارضات الدستور

### 4.4 طبقة المحاكاة

#### legalis-sim
محرك محاكاة بنمط ECS.

**الميزات**:
- محاكاة قائمة على السكان (تدعم ملايين الوكلاء)
- محاكاة Monte Carlo
- تحليل الحساسية
- اختبار A/B
- تسريع GPU (CUDA/OpenCL/WebGPU)

### 4.5 طبقة التدويل

#### legalis-i18n
دعم متعدد اللغات والاختصاصات القضائية.

**الاختصاصات المدعومة**: JP, US, GB, DE, FR, ES, IT, CN, TW, KR, CA, AU, IN, BR, RU, SA, NL, CH, MX, SG

### 4.6 طبقة قابلية التشغيل البيني

#### legalis-interop
التحويل البيني مع صيغ DSL القانونية المتعددة.

**الصيغ المدعومة**:

| الصيغة | الأصل | الميزات |
|--------|-------|---------|
| Catala | Inria, فرنسا | البرمجة الأدبية |
| Stipula | جامعة بولونيا, إيطاليا | العقود الذكية |
| L4 | سنغافورة | المنطق الأخلاقي |
| Akoma Ntoso | OASIS | وثائق تشريعية XML |

### 4.7 طبقة المخرجات

#### legalis-viz
محرك التصور.

#### legalis-chain
توليد العقود الذكية.

**المنصات المدعومة (25+)**:
- EVM: Solidity, Vyper
- Substrate: Ink!
- Move: Aptos, Sui
- StarkNet: Cairo
- Cosmos: CosmWasm

#### legalis-lod
مخرجات Linked Open Data.

---

## 5. التقنيات الأساسية

### 5.1 DSL القانوني

**البنية الأساسية**:
```
STATUTE <id>: "<title>" {
    [JURISDICTION "<jurisdiction>"]
    [VERSION <number>]
    [EFFECTIVE_DATE <date>]

    WHEN <condition>
    THEN <effect>

    [EXCEPTION WHEN <condition>]
    [DISCRETION "<description>"]
}
```

### 5.2 نوع LegalResult<T> وقيم الحقيقة الجزئية

```rust
pub enum LegalResult<T> {
    Deterministic(T),
    JudicialDiscretion {
        issue: String,
        context_id: Uuid,
        narrative_hint: Option<String>,
    },
    Void { reason: String },
}
```

### 5.3 التحقق الرسمي باستخدام Z3 SMT Solver

**أهداف التحقق**:
1. المراجع الدائرية
2. القوانين غير القابلة للوصول
3. التناقضات المنطقية
4. تعارضات الدستور

### 5.4 محرك المحاكاة بنمط ECS

يتبنى محرك المحاكاة نمط Entity-Component-System (ECS):
- **Entity**: وكلاء المواطنين
- **Component**: السمات (العمر، الدخل، الإقامة، إلخ)
- **System**: منطق تطبيق القانون

---

## 6. تنفيذات الاختصاص القضائي

### 6.1 النظام القانوني الياباني

يوفر صندوق legalis-jp تمثيلاً منظماً للدستور الياباني.

### 6.2 ألمانيا، فرنسا، الولايات المتحدة (مخطط)

| الاختصاص | الحالة | مجالات التركيز |
|----------|--------|----------------|
| ألمانيا (DE) | قيد التطوير | BGB, GG |
| فرنسا (FR) | قيد التطوير | Code civil |
| الولايات المتحدة (US) | قيد التطوير | UCC، الدستور |

---

## 7. دراسات الحالة

### 7.1 نظام تحديد أهلية الرعاية الاجتماعية

**النتائج**:
- **قرارات حتمية**: 85% من الحالات
- **JudicialDiscretion**: 15% من الحالات

### 7.2 محاكاة المادة 709 من القانون المدني (الضرر)

**سيناريوهات الاختبار**:
1. ضرر متعمد واضح → `Deterministic(Liable)`
2. ضرر بسبب الإهمال → `Deterministic(Liable)`
3. حالة حدودية → `JudicialDiscretion`

### 7.3 تحليل مقارن لقانون الضرر في 4 دول

| الدولة | القانون | الخصائص |
|--------|---------|---------|
| اليابان | القانون المدني المادة 709 | بند عام (سلطة تقديرية واسعة) |
| ألمانيا | BGB §823/§826 | مصالح محمية معددة |
| فرنسا | Code civil Art. 1240 | تجريد أقصى |
| الولايات المتحدة | قانون السوابق | مصنف (Battery, إلخ) |

---

## 8. مواصفات API والتفاصيل التقنية

### 8.1 الأنواع والسمات الرئيسية

```rust
pub enum LegalResult<T> {
    Deterministic(T),
    JudicialDiscretion { issue: String, context_id: Uuid, narrative_hint: Option<String> },
    Void { reason: String },
}

pub struct Statute {
    pub id: String,
    pub title: String,
    pub primary_effect: Effect,
    pub preconditions: Vec<Condition>,
    pub jurisdiction: String,
}
```

### 8.2 نظام أوامر CLI

```bash
legalis parse <file.dsl> [--format json|yaml]
legalis verify <file.dsl> [--strict]
legalis simulate <file.dsl> --population 1000
legalis visualize <file.dsl> --output tree.svg
legalis export <file.dsl> --format solidity|catala|l4|rdf
```

---

## 9. التقييم

### 9.1 معايير الأداء

| العملية | الهدف | الوقت |
|---------|-------|-------|
| تحليل DSL | 100 قانون | 15ms |
| التحقق | 100 قانون | 250ms |
| المحاكاة | 10,000 وكيل | 1.2s |
| المحاكاة | 100,000 وكيل | 8.5s |

---

## 10. العمل المستقبلي

- واجهة ويب (React)
- امتداد VS Code
- تكامل Jupyter Notebook
- اختصاصات قضائية إضافية

---

## 11. الخلاصة

يقدم Legalis-RS نهجاً جديداً لتقنين القانون بجعل "الحد بين القابلية للحساب والحكم البشري" صريحاً في نظام الأنواع.

**الإنجازات الرئيسية**:

1. **الأساس الفلسفي**: "الحوكمة كرمز، العدالة كسرد"
2. **نظام الأنواع**: منطق ثلاثي القيم عبر `LegalResult<T>`
3. **هندسة معمارية متكاملة**: 7 طبقات و16 صندوق
4. **التنفيذ**: حوالي 450,000 سطر من كود Rust
5. **التحقق**: تكامل Z3 SMT solver
6. **المحاكاة**: محرك بنمط ECS (دعم تسريع GPU)
7. **المخرجات**: 25+ بلوكتشين، RDF/TTL، صيغ متعددة

**الفلسفة الأساسية**: *"ليس كل شيء يجب أن يكون قابلاً للحساب."*

---

## المراجع

1. Lessig, L. (1999). *Code and Other Laws of Cyberspace*. Basic Books.
2. Dworkin, R. (1977). *Taking Rights Seriously*. Harvard University Press.
3. Merigoux, D., Chataing, N., & Protzenko, J. (2021). Catala: A Programming Language for the Law. *ICFP 2021*.
4. Governatori, G., & Shams, Z. (2019). L4: Legal Language and Logic for Law. *JURIX 2019*.
5. de Moura, L., & Bjørner, N. (2008). Z3: An Efficient SMT Solver. *TACAS 2008*.

---

## الملحق

### أ. مواصفات قواعد DSL

```ebnf
statute      = "STATUTE" identifier ":" string "{" body "}" ;
body         = { metadata } when_clause then_clause { exception } { discretion } ;
when_clause  = "WHEN" condition ;
then_clause  = "THEN" effect ;
discretion   = "DISCRETION" string ;
```

### ب. خيارات التكوين

```toml
[legalis]
default_jurisdiction = "SA"
enable_z3 = true
enable_gpu = false
log_level = "info"
```

---

*"Code is Law"، يقولون، لكننا نتخذ نهج "القانون يصبح رمزاً". ومع ذلك، نضمّن نوعاً يسمى 'الإنسانية' في ذلك الرمز.*

---

**فريق تطوير Legalis-RS**
الإصدار 0.2.0 | 2024
